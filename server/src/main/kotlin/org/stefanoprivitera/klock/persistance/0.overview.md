## Database Schema Overview

```mermaid
erDiagram
    USERS ||--o{ USER_DEPARTMENTS : "belongs_to"
    USERS ||--o{ TIME_ENTRIES : "logs"
    USERS ||--o{ EXPENSES : "submits"
    USERS ||--o{ APPROVALS : "approves"

    DEPARTMENTS ||--o{ DEPARTMENTS : "parent_of"
    DEPARTMENTS ||--o{ USER_DEPARTMENTS : "has"
    DEPARTMENTS ||--o{ PROJECTS : "owns"

    PROJECTS ||--o{ TIME_ENTRY_ITEMS : "has"

    TIME_ENTRIES ||--o{ TIME_ENTRY_ITEMS : "contains"
    TIME_ENTRIES ||--o{ APPROVALS : "needs_approval"

    USERS {
        uuid id PK
        string email UK
        string password
        string name
        string surname
        datetime created_at
        datetime updated_at
    }

    DEPARTMENTS {
        uuid id PK
        string name UK
        text description
        uuid parent_department_id FK
    }

    USER_DEPARTMENTS {
        uuid id PK
        uuid user_id FK
        uuid department_id FK
    }

    PROJECTS {
        uuid id PK
        string name
        string customer
        uuid manager_id FK
        uuid department_id FK
        boolean active
        datetime created_at
        datetime updated_at
    }

    TIME_ENTRIES {
        uuid id PK
        uuid user_id FK
        date date
        string type
        decimal total_hours
        jsonb metadata
        string status
        datetime created_at
        datetime updated_at
    }

    TIME_ENTRY_ITEMS {
        uuid id PK
        uuid time_entry_id FK
        uuid project_id FK
        decimal hours
    }

    APPROVALS {
        uuid id PK
        uuid pm_id FK
        uuid time_entry_id FK
        string status
        date approval_date
    }

    EXPENSES {
        uuid id PK
        uuid user_id FK
        date date
        string category
        decimal amount
        string currency
        string status
        datetime created_at
        datetime updated_at
    }


